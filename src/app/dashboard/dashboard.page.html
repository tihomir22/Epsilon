<ion-header>
    <ion-toolbar>
        <ion-buttons slot="start">
            <ion-menu-button></ion-menu-button>
        </ion-buttons>
        <ion-title>
            Dashboard
        </ion-title>
    </ion-toolbar>
</ion-header>

<ion-content color="primary">
    <ion-refresher (ionRefresh)="doRefresh($event)">
        <ion-refresher-content></ion-refresher-content>
    </ion-refresher>

    <ion-card style="color:white;" color="dark">
        <ion-card-header>
            <ion-row>
                <ion-col size="10">
                    <ion-card-title>Bienvenido! {{data.usuario}}</ion-card-title>
                </ion-col>
                <ion-col size="2">
                    <ion-fab-button [routerLink]="[ '/perfil' ]">
                        <ion-img [src]="imagenUsuario"></ion-img>
                    </ion-fab-button>
                </ion-col>
            </ion-row>



        </ion-card-header>
        <ion-card *ngIf="hayActivos">
            <canvas #barCanvas></canvas>
        </ion-card>
        <ion-card-content>


            <ion-row>
                <ion-col size="4">
                    <ion-label>Posesiones Totales</ion-label>
                </ion-col>
                <ion-col size="4">
                    <ion-label>Posesiones Netas</ion-label>
                </ion-col>
                <ion-col size="4">
                    <ion-label>% Total</ion-label>
                </ion-col>
            </ion-row>
            <ion-row>
                <ion-col size="4">
                    <ion-label>{{totalInvertidoBase | number}} </ion-label>
                </ion-col>
                <ion-col size="4">
                    <ion-label>{{totalInvertidoActual | number}} </ion-label>
                </ion-col>
                <ion-col size="4">
                    <ion-label [color]="tenyirLabel(porcentajeNum)">{{porcentajeNum}}</ion-label>
                </ion-col>
            </ion-row>


        </ion-card-content>
        <ion-card color="light">
            <ion-segment scrollable color="success">
                <ion-segment-button value="USD" checked (click)="traducirPrecioUsuario('USD','$')">
                    <ion-chip color="success">
                        <ion-avatar>
                            <img [src]="generarImgForex('united-states')">
                        </ion-avatar>
                        <ion-label>USD</ion-label>
                    </ion-chip>
                </ion-segment-button>
                <ion-segment-button value="EUR" (click)="traducirPrecioUsuario('EUR','€')">
                    <ion-chip color="success">
                        <ion-avatar>
                            <img [src]="generarImgForex('european-union')">
                        </ion-avatar>
                        <ion-label>EUR</ion-label>
                    </ion-chip>
                </ion-segment-button>
                <ion-segment-button value="GBP" (click)="traducirPrecioUsuario('GBP','£')">
                    <ion-chip color="success">
                        <ion-avatar>
                            <img [src]="generarImgForex('united-kingdom')">
                        </ion-avatar>
                        <ion-label>GBP</ion-label>
                    </ion-chip>
                </ion-segment-button>
                <ion-segment-button value="JPY" (click)="traducirPrecioUsuario('JPY','¥')">
                    <ion-chip color="success">
                        <ion-avatar>
                            <img [src]="generarImgForex('japan')">
                        </ion-avatar>
                        <ion-label>JPY</ion-label>
                    </ion-chip>
                </ion-segment-button>
                <ion-segment-button value="AUD" (click)="traducirPrecioUsuario('AUD','$ AUD')">
                    <ion-chip color="success">
                        <ion-avatar>
                            <img [src]="generarImgForex('australia')">
                        </ion-avatar>
                        <ion-label>AUD</ion-label>
                    </ion-chip>
                </ion-segment-button>
                <ion-segment-button value="NZD" (click)="traducirPrecioUsuario('NZD','$ NZD')">
                    <ion-chip color="success">
                        <ion-avatar>
                            <img [src]="generarImgForex('new-zealand')">
                        </ion-avatar>
                        <ion-label>NZD</ion-label>
                    </ion-chip>
                </ion-segment-button>
            </ion-segment>
        </ion-card>
    </ion-card>


    <ion-card *ngIf="!hayActivos" color="secondary">
        <ion-card-header>
            <ion-card-title text-center>Todavia no tienes ningun activo!</ion-card-title>
        </ion-card-header>
        <ion-fab vertical="top" horizontal="end" slot="fixed" (click)="agregarNuevosActivos()">
            <ion-fab-button>
                <ion-icon name="add"></ion-icon>
            </ion-fab-button>
        </ion-fab>
        <ion-card-content>
            <ion-row>
                <ion-col size="5"></ion-col>
                <ion-col size="2">
                    <img src="../../assets/icons/sad.png" alt="" srcset="">
                </ion-col>
                <ion-col size="5"></ion-col>
            </ion-row>

            <p text-center>Empieza a agregarlos desde el boton de la derecha</p>
        </ion-card-content>
    </ion-card>
    <ion-card>


        <ion-list *ngIf="hayActivos" style="padding:0px;">
            <ion-list-header color="medium">
                <ion-label>Seguimiento de activos</ion-label>

            </ion-list-header>

            <ion-item-sliding *ngFor="let activo of service.getArrayActivos()" [attr.id]="'sliding' + activo.id_unico">
                <ion-item style="text-align:center;" (press)="seleccionarItem()" (click)="expandItem(activo)">
                    <ion-icon color="success" *ngIf="activo.rentabilidad.charAt(0)=='+'" name="arrow-dropup"></ion-icon>
                    <ion-icon color="danger" *ngIf="activo.rentabilidad.charAt(0)=='-'" name="arrow-dropdown">
                    </ion-icon>
                    <ion-avatar item-start *ngIf="activo.tipo=='Criptomoneda'">
                        <img [src]="generarImgCripto(activo)" style="border-radius:0%;">
                    </ion-avatar>
                    <ion-avatar item-start *ngIf="activo.tipo=='Stock'">
                        <img [src]="generarImgStock(activo)" style="border-radius:0%;">
                    </ion-avatar>

                    <ion-label style="font-size:14px;">{{activo.PAR_FULL}}</ion-label>
                    <ion-label>{{activo.precio_compra}}</ion-label>
                    <ion-label>{{activo.precio}}</ion-label>
                    <ion-label [color]="tenyirLabel(activo.rentabilidad)">{{activo.rentabilidad}}</ion-label>
                </ion-item>
                <ion-item-options side="start">
                    <ion-item-option (click)="mostrarInfo(activo)" color="warning">
                        <ion-icon slot="start" name="eye" style="font-size:20px;"></ion-icon>
                    </ion-item-option>
                </ion-item-options>
                <ion-item-options side="end">
                    <ion-item-option (click)="eliminar_activo(activo)" color="danger">
                        <ion-icon slot="start" name="trash" style="font-size:20px;"></ion-icon>
                    </ion-item-option>
                </ion-item-options>
                <div class="extendable" [attr.id]="'dembow' + activo.id_unico"
                    style="display:none;border:1px solid white;">
                    <ion-item-group>
                        <ion-item color="dark">
                            <ion-label color="primary"><strong> Precio inicial : </strong>{{activo.precio_compra}}
                                {{activo.contrapartida}}</ion-label>
                        </ion-item>
                        <ion-item color="dark">
                            <ion-label color="primary"><strong> Precio Actual : </strong>{{activo.precio}}
                                {{activo.contrapartida}}</ion-label>
                        </ion-item>
                        <ion-item color="dark">
                            <ion-label color="primary"><strong>Cantidad : </strong>{{activo.cantidad}} {{activo.siglas}}
                            </ion-label>
                        </ion-item>
                        <ion-item color="dark">
                            <ion-label color="primary"><strong>Exchange : </strong>{{activo.exchange}}</ion-label>
                        </ion-item>
                        <ion-item color="dark">
                            <ion-label color="primary"><strong>Tipo : </strong>{{activo.tipoRelacion}}</ion-label>
                        </ion-item>
                        <ion-item color="dark">
                            <ion-label color="primary"><strong>Fecha : </strong>{{activo.fecha_operacion}}</ion-label>
                        </ion-item>
                        <ion-item color="dark">

                            <ion-button expand="full" shape="round" color="secondary" fill="outline"
                                (click)="expandItem(activo)">
                                <ion-icon name="arrow-dropup"></ion-icon> Cerrar
                            </ion-button>
                            <ion-button expand="full" shape="round" color="danger" fill="outline"
                                (click)="eliminar_activo(activo)">
                                <ion-icon name="trash"></ion-icon> Eliminar
                            </ion-button>
                            <ion-button expand="full" shape="round" color="warning" fill="outline"
                                *ngIf="activo.de_exchange==1" (click)="abrirOperacionesExchange()">
                                <ion-icon slot="start" name="analytics" style="margin:5px;"></ion-icon>
                                Operaciones
                                <ion-select interface="action-sheet" placeholder="">
                                    <ion-select-option value="peperoni">Peperoni</ion-select-option>
                                    <ion-select-option value="hawaii">Hawaii</ion-select-option>
                                </ion-select>

                            </ion-button>

                        </ion-item>


                    </ion-item-group>

                </div>

            </ion-item-sliding>


        </ion-list>

    </ion-card>

</ion-content>